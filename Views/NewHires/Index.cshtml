@model IEnumerable<IT_Control_Tower.NewHire>

@{
    ViewBag.Title = "Index";
}
<div>
    <ol class="breadcrumb" style="position:fixed;width:100%;z-index:999;">
        <li>@Html.ActionLink("Home", "Index", "Home")</li>
        <li>@Html.ActionLink("HAM", "Index", "HAM")</li>
        <li>@Html.ActionLink("New Hires", "Index", "NewHires")</li>
    </ol>
</div>
<div class="container" style="margin-top:4rem;">
    @using (Html.BeginForm("Index", "NewHires", FormMethod.Get))
    {
        <h2 style="color:#009e4d;">New Hire Management</h2>
        <b>Search:</b>
        @Html.TextBox("searchText")
        <input type="submit" value="Search" />
    }
    <p>
        </br>
        <input type="button" class="btn btn-info" value="Create New Hire" onclick="location.href='@Url.Action("Create")'" style="background-color:#009e4d;" />
    </p>
    <button1 class="btn btn-info" >Show/Hide T0</button1>
    <button2 class="btn btn-warning">Show/Hide T3</button2>
    <button3 class="btn btn-default">Show/Hide T5</button3>
    @*T - 0 Table*@
    <div>

        @Html.Grid(Model.Where(c => c.StartDate.Subtract(DateTime.Today).TotalDays.Equals(0))).Named("NHT0").Columns(columns =>
    {
        columns.Add(col => col.SESA, false).Titled("SESA");
        columns.Add(col => col.StartDate, false).Titled("Start Date");
        columns.Add(col => col.Assignee, false).Titled("Assignee");
        columns.Add(col => col.Email, false).Titled("Email");
        columns.Add(col => col.Box, false).Titled("Box");
        columns.Add(col => col.Computer, false).Titled("Computer");
        columns.Add(col => col.Headset, false).Titled("Headset");
        columns.Add(col => col.Printer, false).Titled("Printer");
        columns.Add(col => col.Statuses, false).Titled("Status");
        columns.Add().SetWidth(10).Titled("Edit")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Edit", "Edit", new { id = col.SESA }));
        columns.Add().SetWidth(10).Titled("Details")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Details", "Details", new { id = col.SESA }));
        columns.Add().SetWidth(10).Titled("Delete")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Delete", "Delete", new { id = col.SESA }));


    }).Sortable().Filterable().WithPaging(10).Selectable(false)

    </div>
    @*T - 3 Table*@
    <div>

        @Html.Grid(Model.Where(c => c.StartDate.Subtract(DateTime.Today).TotalDays.Equals(3))).Named("NHT3").Columns(columns =>
    {
        columns.Add(col => col.SESA, false).Titled("SESA");
        columns.Add(col => col.StartDate, false).Titled("Start Date");
        columns.Add(col => col.Assignee, false).Titled("Assignee");
        columns.Add(col => col.Email, false).Titled("Email");
        columns.Add(col => col.Box, false).Titled("Box");
        columns.Add(col => col.Computer, false).Titled("Computer");
        columns.Add(col => col.Headset, false).Titled("Headset");
        columns.Add(col => col.Printer, false).Titled("Printer");
        columns.Add(col => col.Statuses, false).Titled("Status");
        columns.Add().SetWidth(10).Titled("Edit")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Edit", "Edit", new { id = col.SESA }));
        columns.Add().SetWidth(10).Titled("Details")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Details", "Details", new { id = col.SESA }));
        columns.Add().SetWidth(10).Titled("Delete")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Delete", "Delete", new { id = col.SESA }));


    }).Sortable().Filterable().WithPaging(10).Selectable(false)

    </div>
    @*T - 5 Table*@
    <div>

        @Html.Grid(Model.Where(c => c.StartDate.Subtract(DateTime.Today).TotalDays.Equals(5))).Named("NHT5").Columns(columns =>
    {
        columns.Add(col => col.SESA, false).Titled("SESA");
        columns.Add(col => col.StartDate, false).Titled("Start Date");
        columns.Add(col => col.Assignee, false).Titled("Assignee");
        columns.Add(col => col.Email, false).Titled("Email");
        columns.Add(col => col.Box, false).Titled("Box");
        columns.Add(col => col.Computer, false).Titled("Computer");
        columns.Add(col => col.Headset, false).Titled("Headset");
        columns.Add(col => col.Printer, false).Titled("Printer");
        columns.Add(col => col.Statuses, false).Titled("Status");
        columns.Add().SetWidth(10).Titled("Edit")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Edit", "Edit", new { id = col.SESA }));
        columns.Add().SetWidth(10).Titled("Details")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Details", "Details", new { id = col.SESA }));
        columns.Add().SetWidth(10).Titled("Delete")
        .Encoded(false)
        .Sanitized(false).RenderValueAs(col => @Html.ActionLink("Delete", "Delete", new { id = col.SESA }));


    }).Sortable().Filterable().WithPaging(10).Selectable(false)

    </div>
    @section Scripts {

        <script src="@Url.Content("~/Scripts/gridmvc.min.js")" type="text/javascript"></script>
        <script type="text/javascript">
            $('tr').each(function (index) { //iterate over all table rows
                if (index > 0) {     //skip header
                    var today = new Date();
                    //console.log(d.getMonth() + 1);
                    //slice to date format
                    var slice = $(this).children('td:nth-child(2)').text().substring(0, $(this).children('td:nth-child(2)').text().length - 3)
                    //Change / to -, before converting to date obj
                    var date = new Date(slice.replace(/\//g, '-'));
                    //Change from millis to days
                    var days = Math.ceil(Math.floor((today - date) / 3600) / 24000);
                    console.log(date);
                    //Days more than 5
                    if (days > 5) {
                        $(this).children('td:nth-child(2)').css("background-color", "#90EE90");
                    }
                    //Overdue
                    else if (days < 0) {
                        $(this).children('td:nth-child(2)').css("background-color", "#DCDCDC");
                    }
                    //T-5 to T-0
                    switch (days) {

                        case 5:
                            $(this).children('td:nth-child(2)').css("background-color", "#32CD32");
                            break;
                        case 4:
                            $(this).children('td:nth-child(2)').css("background-color", "#FFFF99");
                            break;
                        case 3:
                            $(this).children('td:nth-child(2)').css("background-color", "#FFFF00");
                            break;
                        case 2:
                            $(this).children('td:nth-child(2)').css("background-color", "#FFd589");
                            break;
                        case 1:
                            $(this).children('td:nth-child(2)').css("background-color", "#FFB327");
                            break;
                        case 0:
                            $(this).children('td:nth-child(2)').css("background-color", "#FF0000");
                            break;

                    }



                    //if ($(this).children('td:nth-child(2)').text().substring(0, 1) == Date.now)  //look for the 3rd td in each row. thats where your age is.
                    //{
                    //    $(this).children('td:nth-child(2)').css("background-color", "green");
                    //}
                    //else {
                    //    $(this).children('td:nth-child(2)').css("background-color", "red");
                    //}

                }
            });
            $('button1').click(function () {
                if ($('table').children('NHT0').is(':visible')) {
                    $('table').children('NHT0').hide()
                } else {
                    $('table').children('NHT0').show()
                }
            })
            $('button2').click(function () {
                if ($('table').is(':visible')) {
                    $('table').hide()
                } else {
                    $('table').show()
                }
            })
            $('button3').click(function () {
                if ($('table').is(':visible')) {
                    $('table').hide()
                } else {
                    $('table').show()
                }
            })
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    }

</table>
